#
# Copyright (c) SAS Institute Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

class GroupRWBSAppliance(GroupSetRecipe):
    name = 'group-rwbs-appliance'
    version = 'tip'

    windows_label = 'windows.rpath.com@rpath:windows-common'

    def setup(r):
        r.dumpAll()

        base = r.Repository(r.cfg.buildLabel, r.flavor)
        windows_platform = r.Repository(r.windows_label, r.flavor).find(
            'group-rpath-packages')
        windows_tools = r.Repository(r.macros.contrib_label, r.flavor)

        sp = r.SearchPath(base, windows_tools, windows_platform)


#        standard = windows_platform.find('group-standard')
#        standard -= standard.find('rPathTools')
        rwbs = base.find('rwbs')
        rpathTools = base.find('rPathTools')

        deps = (rwbs + rpathTools).depsNeeded(sp)

        r.Group(rwbs + rpathTools + deps)
